{"version":3,"sources":["js/helpers/Globals.js","js/functions/PlayIcon.js","audio/rectangles-no-6.ogg","audio/rectangles-no-6.mid","js/classes/Rectangle.js","js/P5SketchWithAudio.js","js/App.js","index.js"],"names":["window","p5","PlayIcon","id","className","xmlns","height","viewBox","width","d","fill","Rectangle","x","y","maxWidth","maxHeight","speed","this","p","rect","P5SketchWithAudio","sketchRef","useRef","Sketch","canvas","canvasWidth","innerWidth","canvasHeight","innerHeight","audioLoaded","player","PPQ","loadMidi","Midi","fromUrl","midi","then","result","console","log","noteSet1","tracks","notes","scheduleCueSet","document","getElementById","classList","add","remove","preload","song","loadSound","audio","onended","logCredits","noteSet","callbackName","poly","lastTicks","currentCue","i","length","note","ticks","time","addCue","rectangles","setup","createCanvas","background","rectMode","CENTER","draw","isPlaying","forEach","rectangle","update","useFirstSequence","sequence1","sequence2","loopNum","executeCueSet1","mod","currentSequence","includes","clear","bgColour","Math","random","stroke","index","xDivisor","loopMultiplier","r","g","b","colour","color","push","mousePressed","pause","parseInt","currentTime","buffer","duration","reset","play","creditsLogged","stop","updateCanvasDimensions","resizeCanvas","attachEvent","addEventListener","useEffect","current","ref","App","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.46e5c471.chunk.js","sourcesContent":["// p5.sound doesn't work correctly when p5 is not available in the global name space so we add it here\n// https://github.com/processing/p5.js-sound/issues/512\nimport * as p5 from \"p5\";\nwindow.p5 = p5;\n","export default function PlayIcon() {\n    return (\n        <svg id=\"play-icon\" className='fade-out' xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n            <path d=\"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\" />\n        </svg>\n    )\n}\n","export default __webpack_public_path__ + \"static/media/rectangles-no-6.b547a8d8.ogg\";","export default __webpack_public_path__ + \"static/media/rectangles-no-6.e7bf9ce7.mid\";","export default class Rectangle {\r\n    constructor(p5, x, y, fill, maxWidth, maxHeight, speed) {\r\n        this.p = p5;\r\n        this.x = x;\r\n        this.y = y;\r\n        this.fill = fill;\r\n        this.maxWidth = maxWidth;\r\n        this.maxHeight = maxHeight;\r\n        this.speed = speed;\r\n        this.width = 0;\r\n        this.height = 0;\r\n    }\r\n\r\n    update() {\r\n        if(this.width < this.maxWidth) {\r\n            this.width = this.width + this.speed;\r\n        }\r\n        if(this.height < this.maxHeight) {\r\n            this.height = this.height + this.speed;\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        this.p.fill(this.fill);\r\n        this.p.rect(this.x, this.y, this.width, this.height);\r\n    }\r\n}","import React, { useRef, useEffect } from \"react\";\nimport \"./helpers/Globals\";\nimport \"p5/lib/addons/p5.sound\";\nimport * as p5 from \"p5\";\nimport { Midi } from '@tonejs/midi'\nimport PlayIcon from './functions/PlayIcon.js';\n\nimport audio from \"../audio/rectangles-no-6.ogg\";\nimport midi from \"../audio/rectangles-no-6.mid\";\nimport Rectangle from \"./classes/Rectangle\";\n\nconst P5SketchWithAudio = () => {\n    const sketchRef = useRef();\n\n    const Sketch = p => {\n\n        p.canvas = null;\n\n        p.canvasWidth = window.innerWidth;\n\n        p.canvasHeight = window.innerHeight;\n\n        p.audioLoaded = false;\n\n        p.player = null;\n\n        p.PPQ = 3840 * 4;\n\n        p.loadMidi = () => {\n            Midi.fromUrl(midi).then(\n                function(result) {\n                    console.log(result);\n                    const noteSet1 = result.tracks[11].notes; // NN19 1 - Ghost (only used to sequence the animation)\n                    p.scheduleCueSet(noteSet1, 'executeCueSet1');\n                    p.audioLoaded = true;\n                    document.getElementById(\"loader\").classList.add(\"loading--complete\");\n                    document.getElementById(\"play-icon\").classList.remove(\"fade-out\");\n                }\n            );\n            \n        }\n\n        p.preload = () => {\n            p.song = p.loadSound(audio, p.loadMidi);\n            p.song.onended(p.logCredits);\n        }\n\n        p.scheduleCueSet = (noteSet, callbackName, poly = false)  => {\n            let lastTicks = -1,\n                currentCue = 1;\n            for (let i = 0; i < noteSet.length; i++) {\n                const note = noteSet[i],\n                    { ticks, time } = note;\n                if(ticks !== lastTicks || poly){\n                    note.currentCue = currentCue;\n                    p.song.addCue(time, p[callbackName], note);\n                    lastTicks = ticks;\n                    currentCue++;\n                }\n            }\n        } \n\n        p.rectangles = [];\n\n        p.setup = () => {\n            p.canvas = p.createCanvas(p.canvasWidth, p.canvasHeight);\n            p.background(0);\n            p.rectMode(p.CENTER);\n        }\n\n        p.draw = () => {\n            if(p.audioLoaded && p.song.isPlaying()){\n                p.rectangles.forEach(rectangle => {\n                    rectangle.draw();\n                    rectangle.update();\n                });\n            }\n        }\n\n        p.useFirstSequence = true;\n\n        p.sequence1 = [\n            {x: 1, y: 1},\n            {x: 2, y: 1},\n            {x: 3, y: 1},\n            {x: 4, y: 1},\n            {x: 1, y: 2},\n            {x: 2, y: 2},\n            {x: 3, y: 2},\n            {x: 4, y: 2},\n        ];\n\n        p.sequence2 = [\n            {x: 1, y: 1},\n            {x: 2, y: 1},\n            {x: 3, y: 1},\n            {x: 4, y: 1},\n            {x: 1, y: 2},\n            {x: 2, y: 2},\n            {x: 3, y: 2},\n        ];\n\n        p.loopNum = 1;\n\n        p.executeCueSet1 = (note) => {\n            const { currentCue } = note;\n            const mod = currentCue % 15;\n            const currentSequence = p.useFirstSequence ? p.sequence1 : p.sequence2;\n            if([1, 9].includes(mod)) {\n                p.clear();\n                const bgColour = Math.random() > 0.5 ? 0 : 255;\n                p.background(bgColour);\n                p.stroke(bgColour);\n                p.rectangles = [];\n            }\n            const index = mod === 0 ? 6 : mod < 9 ? mod - 1 : mod - 9; \n            const xDivisor = index > 3 && !p.useFirstSequence ? 3 : 4;\n            const x = p.width / xDivisor * currentSequence[index].x - p.width / (xDivisor * 2);\n            const y = p.height / 2 * currentSequence[index].y - p.height / 4;\n            \n\n            for (let i = 0; i < p.loopNum; i++) {\n                const loopMultiplier =  (1 - (p.random(0.1, 0.3) * i));\n                const r = p.random(0, 255);\n                const g = p.random(0, 255);\n                const b = p.random(0, 255);\n                const colour = p.color(\n                    r,\n                    g,\n                    b,\n                    p.random(0, 191)\n                );\n\n                p.rectangles.push(\n                    new Rectangle(\n                        p, \n                        x,\n                        y,\n                        colour,\n                        (p.width / xDivisor) * loopMultiplier,\n                        (p.height / 2) * loopMultiplier,\n                        9 - i\n                    )\n                );\n            }\n            \n\n            if([0, 8].includes(mod)) {\n                p.useFirstSequence = !p.useFirstSequence;\n                p.loopNum++;\n            }\n        }\n\n        p.mousePressed = () => {\n            if(p.audioLoaded){\n                if (p.song.isPlaying()) {\n                    p.song.pause();\n                } else {\n                    if (parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)) {\n                        p.reset();\n                    }\n                    document.getElementById(\"play-icon\").classList.add(\"fade-out\");\n                    p.song.play();\n                }\n            }\n        }\n\n        p.creditsLogged = false;\n\n        p.logCredits = () => {\n            if (\n                !p.creditsLogged &&\n                parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)\n            ) {\n                p.creditsLogged = true;\n                    console.log(\n                    \"Music By: http://labcat.nz/\",\n                    \"\\n\",\n                    \"Animation By: https://github.com/LABCAT/rectangles-no-6\",\n                    \"\\n\",\n                    \"Coding Inspiration: https://openprocessing.org/sketch/824318\"\n                );\n                p.song.stop();\n            }\n        };\n\n        p.reset = () => {\n\n        }\n\n        p.updateCanvasDimensions = () => {\n            p.canvasWidth = window.innerWidth;\n            p.canvasHeight = window.innerHeight;\n            p.canvas = p.resizeCanvas(p.canvasWidth, p.canvasHeight);\n        }\n\n        if (window.attachEvent) {\n            window.attachEvent(\n                'onresize',\n                function () {\n                    p.updateCanvasDimensions();\n                }\n            );\n        }\n        else if (window.addEventListener) {\n            window.addEventListener(\n                'resize',\n                function () {\n                    p.updateCanvasDimensions();\n                },\n                true\n            );\n        }\n        else {\n            //The browser does not support Javascript event binding\n        }\n    };\n\n    useEffect(() => {\n        new p5(Sketch, sketchRef.current);\n    }, []);\n\n    return (\n        <div ref={sketchRef}>\n            <PlayIcon />\n        </div>\n    );\n};\n\nexport default P5SketchWithAudio;\n","import P5SketchWithAudio from './P5SketchWithAudio'\n\nfunction App() {\n  return (\n    <P5SketchWithAudio/>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/build.css';\nimport App from './js/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}